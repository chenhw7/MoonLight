# 简历生成前端设计文档

## 1. 功能概述

### 1.1 目标
实现一个功能完善的简历生成页面，支持校招和社招两种模式，通过标签页切换不同模块，提供实时预览功能。

### 1.2 页面定位
- **路由**: `/resume/create`
- **访问权限**: 需要登录
- **响应式**: 支持桌面端和移动端

---

## 2. 页面布局设计

### 2.1 整体布局

```
┌─────────────────────────────────────────────────────────────────────┐
│  Header (固定)                                                       │
│  [Logo]  简历生成                                    [保存] [预览]   │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │  模式切换                                                    │   │
│  │  [校招模式 ○]  [社招模式 ●]                                  │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │  标签页导航                                                   │   │
│  │  ┌─────────┬──────────┬──────────┬──────────┬──────────┐     │   │
│  │  │ 基本信息 │ 教育经历  │ 工作/实习 │ 项目经历  │ 技能与其他│     │   │
│  │  └─────────┴──────────┴──────────┴──────────┴──────────┘     │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │  表单内容区域 (可滚动)                                         │   │
│  │                                                              │   │
│  │  ┌────────────────────────────────────────────────────────┐ │   │
│  │  │  当前标签页对应的表单内容                                 │ │   │
│  │  │  - 基本信息: 姓名、手机、邮箱等                           │ │   │
│  │  │  - 教育经历: 多条记录，可添加/删除/排序                    │ │   │
│  │  │  - 工作经历: 多条记录                                      │ │   │
│  │  │  - ...                                                    │ │   │
│  │  └────────────────────────────────────────────────────────┘ │   │
│  │                                                              │   │
│  │  ┌────────────────────────────────────────────────────────┐ │   │
│  │  │  [+ 添加更多]                                            │ │   │
│  │  └────────────────────────────────────────────────────────┘ │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │  底部导航                                                    │   │
│  │  [上一步]              [下一步]  [预览简历]                  │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 2.2 桌面端 - 分栏布局（带实时预览）

```
┌─────────────────────────────────────────────────────────────────────┐
│  Header (固定)                                                       │
│  [Logo]  简历生成                                    [保存] [预览]   │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  ┌─────────────────────────────────────┬────────────────────────┐  │
│  │                                     │                        │  │
│  │  左侧: 表单编辑区 (60%)              │  右侧: 实时预览区 (40%) │  │
│  │  ─────────────────────────────      │  ────────────────────  │  │
│  │  [模式切换]                         │                        │  │
│  │  [标签页导航]                        │   ┌────────────────┐   │  │
│  │  [表单内容 - 可滚动]                 │   │                │   │  │
│  │                                     │   │   简历预览      │   │  │
│  │  ┌─────────────────────────────┐   │   │   (实时渲染)    │   │  │
│  │  │  表单字段...                 │   │   │                │   │  │
│  │  │  ...                        │   │   │   A4纸样式     │   │  │
│  │  │                             │   │   │   可缩放查看    │   │  │
│  │  └─────────────────────────────┘   │   │                │   │  │
│  │                                     │   └────────────────┘   │  │
│  │  [底部导航]                         │                        │  │
│  │                                     │   [下载PDF] [关闭预览]  │  │
│  └─────────────────────────────────────┴────────────────────────┘  │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 2.3 移动端布局

```
┌─────────────────────────────────────┐
│  Header                             │
│  [←] 简历生成        [保存] [👁]    │
├─────────────────────────────────────┤
│                                     │
│  [校招 ○] [社招 ●]                  │
│                                     │
│  ┌─────┬─────┬─────┬─────┬─────┐   │
│  │ 基本 │ 教育 │ 工作 │ 项目 │ 技能│   │
│  └─────┴─────┴─────┴─────┴─────┘   │
│                                     │
│  ┌─────────────────────────────┐   │
│  │                             │   │
│  │      表单内容区域            │   │
│  │      (垂直滚动)              │   │
│  │                             │   │
│  │  姓名: [________________]   │   │
│  │  手机: [________________]   │   │
│  │  ...                        │   │
│  │                             │   │
│  │  [+ 添加更多]               │   │
│  │                             │   │
│  └─────────────────────────────┘   │
│                                     │
│  ┌─────────────────────────────┐   │
│  │  [< 上一步]  [下一步 >]     │   │
│  └─────────────────────────────┘   │
│                                     │
└─────────────────────────────────────┘
```

---

## 3. 组件设计

### 3.1 组件层次结构

```
ResumeCreatePage (页面)
├── ResumeHeader (头部)
│   ├── ModeSwitch (校招/社招切换)
│   └── ActionButtons (保存/预览按钮)
├── ResumeLayout (布局容器)
│   ├── ResumeForm (左侧表单区)
│   │   ├── TabNavigation (标签页导航)
│   │   └── TabContent (标签页内容)
│   │       ├── BasicInfoForm (基本信息)
│   │       ├── EducationForm (教育经历)
│   │       ├── WorkExperienceForm (工作/实习经历)
│   │       ├── ProjectForm (项目经历)
│   │       └── SkillsForm (技能与其他)
│   └── ResumePreview (右侧预览区)
│       └── ResumeTemplate (简历模板渲染)
└── ResumeFooter (底部导航)
    └── StepNavigation (上一步/下一步)
```

### 3.2 核心组件说明

#### ResumeCreatePage
- **职责**: 页面容器，协调各子组件
- **状态**: 当前标签页、简历数据、预览开关
- **功能**: 初始化数据、处理保存、切换预览

#### ModeSwitch
- **职责**: 校招/社招模式切换
- **状态**: 当前模式
- **功能**: 切换时保留通用数据，提示字段变化

#### TabNavigation
- **职责**: 标签页导航
- **标签**: 基本信息、教育经历、工作/实习、项目经历、技能与其他
- **功能**: 点击切换、显示完成状态指示器

#### DynamicForm (动态表单组件)
- **职责**: 可重复添加的表单模块
- **功能**: 
  - 添加/删除记录
  - 拖拽排序
  - 表单验证
  - 自动保存草稿

#### ResumePreview
- **职责**: 实时简历预览
- **功能**:
  - 实时渲染表单数据
  - A4纸样式展示
  - 缩放控制
  - 下载PDF

---

## 4. 数据流设计

### 4.1 状态管理

```typescript
// 使用 Zustand 管理全局状态
interface ResumeState {
  // 当前编辑的简历
  currentResume: Resume | null;
  
  // 表单数据 (本地编辑状态)
  formData: ResumeFormData;
  
  // UI 状态
  currentTab: TabType;
  resumeMode: 'campus' | 'social';
  isPreviewOpen: boolean;
  isDirty: boolean; // 是否有未保存的更改
  
  // 操作
  setCurrentTab: (tab: TabType) => void;
  setResumeMode: (mode: 'campus' | 'social') => void;
  updateFormData: (data: Partial<ResumeFormData>) => void;
  saveResume: () => Promise<void>;
  togglePreview: () => void;
}
```

### 4.2 数据流图

```
┌─────────────────────────────────────────────────────────────┐
│                      用户操作                               │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                   ResumeForm (表单组件)                      │
│  - 处理用户输入                                              │
│  - 本地表单验证                                              │
└─────────────────────────────────────────────────────────────┘
                              │
                              │ 更新本地状态
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                   ResumeStore (Zustand)                      │
│  - 管理 formData                                             │
│  - 标记 isDirty = true                                       │
└─────────────────────────────────────────────────────────────┘
                              │
              ┌───────────────┴───────────────┐
              │                               │
              ▼                               ▼
┌─────────────────────────┐      ┌─────────────────────────┐
│    ResumePreview        │      │    AutoSave (定时)      │
│    (实时预览)            │      │    - 每30秒保存草稿      │
│                         │      │    - 页面离开提示        │
└─────────────────────────┘      └─────────────────────────┘
                                          │
                                          ▼
                              ┌─────────────────────────┐
                              │    ResumeService        │
                              │    (API 调用)            │
                              │    - POST /resumes      │
                              │    - PUT /resumes/:id   │
                              └─────────────────────────┘
```

---

## 5. 响应式设计

### 5.1 断点设计

| 断点 | 宽度 | 布局 |
|------|------|------|
| 移动端 | < 768px | 单列布局，预览全屏弹窗 |
| 平板 | 768px - 1024px | 单列布局，预览侧边抽屉 |
| 桌面端 | > 1024px | 双栏布局，右侧固定预览 |

### 5.2 移动端适配策略

1. **表单区域**: 全宽显示，垂直滚动
2. **标签页**: 横向滚动，显示简化标签名
3. **预览**: 点击预览按钮后全屏显示
4. **底部导航**: 固定在底部，方便操作

---

## 6. 交互设计

### 6.1 标签页切换

- 点击标签切换内容
- 未保存数据自动保存到本地状态
- 切换时验证当前标签页必填项（可选）

### 6.2 动态添加/删除

- 每个可重复模块提供"+ 添加"按钮
- 新添加的表单自动展开并聚焦
- 删除前二次确认
- 支持拖拽排序（桌面端）

### 6.3 自动保存

- 每30秒自动保存草稿到 localStorage
- 离开页面时提示保存
- 手动保存按钮随时可用
- 显示"已保存"/"未保存"状态指示

### 6.4 实时预览

- 表单数据变化实时同步到预览区
- 预览区显示 A4 纸样式
- 支持缩放查看
- 提供下载PDF功能

---

## 7. 技术实现

### 7.1 依赖库

```json
{
  "dependencies": {
    "@dnd-kit/core": "^6.0.0",        // 拖拽排序
    "@dnd-kit/sortable": "^7.0.0",
    "@dnd-kit/utilities": "^3.0.0",
    "react-hook-form": "^7.48.0",      // 表单管理
    "@hookform/resolvers": "^3.3.0",   // 表单验证
    "zod": "^3.22.0",                  // 数据验证
    "html2canvas": "^1.4.0",           // 截图导出
    "jspdf": "^2.5.0"                  // PDF生成
  }
}
```

### 7.2 文件结构

```
frontend/src/
├── pages/
│   └── Resume/
│       ├── index.tsx                 # 页面入口
│       ├── ResumeCreate.tsx          # 主组件
│       ├── components/
│       │   ├── ResumeHeader.tsx      # 头部组件
│       │   ├── ModeSwitch.tsx        # 模式切换
│       │   ├── TabNavigation.tsx     # 标签导航
│       │   ├── ResumeForm.tsx        # 表单容器
│       │   ├── ResumePreview.tsx     # 预览组件
│       │   ├── ResumeFooter.tsx      # 底部导航
│       │   └── forms/
│       │       ├── BasicInfoForm.tsx # 基本信息
│       │       ├── EducationForm.tsx # 教育经历
│       │       ├── WorkExperienceForm.tsx # 工作经历
│       │       ├── ProjectForm.tsx   # 项目经历
│       │       └── SkillsForm.tsx    # 技能与其他
│       └── hooks/
│           └── useResumeForm.ts      # 表单逻辑Hook
├── services/
│   └── resume.ts                     # 简历API服务
├── stores/
│   └── resumeStore.ts                # 简历状态管理
├── types/
│   └── resume.ts                     # 简历类型定义
└── utils/
    └── resumeTemplate.ts             # 简历模板工具
```

---

## 8. 表单验证规则

### 8.1 基本信息验证

| 字段 | 验证规则 | 错误提示 |
|------|----------|----------|
| 姓名 | 必填, 2-20字符 | 请输入姓名 |
| 手机号 | 必填, 手机号格式 | 请输入正确的手机号 |
| 邮箱 | 必填, 邮箱格式 | 请输入正确的邮箱 |
| 期望城市 | 必填, 至少1个 | 请选择期望城市 |

### 8.2 教育经历验证

| 字段 | 验证规则 | 错误提示 |
|------|----------|----------|
| 学校名称 | 必填 | 请输入学校名称 |
| 学历 | 必填 | 请选择学历 |
| 专业 | 必填 | 请输入专业 |
| 起止时间 | 必填, 结束>开始 | 请选择正确的起止时间 |

### 8.3 工作/实习经历验证

| 字段 | 验证规则 | 错误提示 |
|------|----------|----------|
| 公司名称 | 必填 | 请输入公司名称 |
| 职位名称 | 必填 | 请输入职位名称 |
| 起止时间 | 必填 | 请选择起止时间 |
| 工作描述 | 必填, 最少20字 | 请详细描述工作内容 |

---

## 9. 错误处理

### 9.1 表单错误

- 实时验证，即时显示错误信息
- 提交时全量验证
- 错误信息定位到具体字段

### 9.2 API 错误

- 显示友好的错误提示
- 网络错误提供重试按钮
- 保存失败保留本地数据

### 9.3 边界情况

- 浏览器刷新前提示保存
- 多标签页同步（可选）
- 数据恢复机制

---

## 10. 性能优化

1. **组件懒加载**: 标签页内容按需加载
2. **防抖处理**: 表单输入防抖保存
3. **虚拟滚动**: 大量经历记录时使用
4. **缓存策略**: 合理使用 React Query 缓存
5. **图片优化**: 头像上传压缩处理
